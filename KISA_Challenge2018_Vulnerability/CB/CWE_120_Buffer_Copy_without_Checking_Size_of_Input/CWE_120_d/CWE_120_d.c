// gcc -z execstack -o ./CB ./CWE_120_d.c -fno-pie -fno-stack-protector -mpreferred-stack-boundary=2 -m32
#include <stdio.h>

void shell(){
	system("/bin/sh");
}

void cpy(char *src){
	char dst[128]={0,};

	strcpy(dst,src);
	
}

void read_(char *buf,int len_){
	read(0,buf,len_);
}

void write_(char *buf){
	write(1,buf,strlen(buf));
}

int len(){
	int len_=0;;
		
	scanf("%d",&len_);
	
	return len_;
}

void menu(){
	puts("1.read");
	puts("2.write");
	puts("3.cpy");
	puts("4.length");
	printf("> ");
}

int main(int argc, char* argv[]){
	
	char buf[1024]={0,};
	int choice=0;
	int length=0;

	setbuf(stdin,0LL);
	setbuf(stdout,0LL);
	setbuf(stderr,0LL);

	for(;;){
		menu();
		scanf("%d",&choice);
		
		if(choice == 1){
			read_(buf,length);
		}
		else if(choice == 2){
			write_(buf);
		}
		else if(choice == 3){
			cpy(buf);
		}
		else if(choice ==4){
			length=len();
		}
		else{
			puts("attack fail");
		}
	
	}
	return 0;
}
