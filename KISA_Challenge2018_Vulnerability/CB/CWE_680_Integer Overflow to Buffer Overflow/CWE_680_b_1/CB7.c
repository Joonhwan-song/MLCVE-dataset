//CWE-680: Integer Overflow to Buffer Overflow
//Not ASLR
//Not NX bit
//gcc -fno-stack-protector -z execstack -o ./CB ./CWE_680_b.c -m32
#include <stdio.h>
 
 
void shell(){
    system("/bin/sh");
}
 
void func(){
     
    char buf[32];
    char size=0;
 
    printf("Input size: ");
     
    scanf("%d",&size);
     
 
    if (size > 32){
        printf("OVERFLOW\n");
        exit(-1);
    }
 
    read(0,buf,size);   
}
int main(){
    setbuf(stdin, 0LL);
    setbuf(stdout, 0LL);
    setbuf(stderr, 0LL);
    func();
    puts("attack fail"); 
    return 0;
}
