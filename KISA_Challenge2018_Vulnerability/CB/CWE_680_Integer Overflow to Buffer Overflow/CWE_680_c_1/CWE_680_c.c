//CWE-680: Integer Overflow to Buffer Overflow
//Not ASLR
//Not NX bit
//gcc -fno-stack-protector -z execstack -o ./CB ./CWE_680_c.c -m32
#include <stdio.h>
 
 
void shell(){
    system("/bin/sh");
}
 
void func(int len){
     
    char buf[32];
    char size=0;
 
    printf("Input size: ");
     
    scanf("%d",&size);
     
 
    if (size > 32 || size > len){
        printf("OVERFLOW\n");
        exit(-1);
    }
 
    read(0,buf,size);   
}
int main(){

    char len;

    setbuf(stdin, 0LL);
    setbuf(stdout, 0LL);
    setbuf(stderr, 0LL);

    printf("Input len: ");
    scanf("%d",&len);

    func(len);
	puts("attack fail"); 
    return 0;
}
