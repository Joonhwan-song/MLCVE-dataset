//gcc -o CB CWE_416_a.c -fno-stack-protector -mpreferred-stack-boundary=2 -m32
#include <stdio.h>

void solve(){
	system("/bin/sh");
}
struct mem{
	void (*info)();
};
void info(){
	puts("hi");
}
int func(){
	char *name;
	struct mem *t = malloc(sizeof(struct mem));	
	t->info = (void *)&info;
	t->info();
	scanf("%d", &name);
	if((int)name == 10) free(t);
	name = malloc(4);
	read(0,name,4);
	t->info();
}

int main(){
        func();
        puts("attack fail");
}
