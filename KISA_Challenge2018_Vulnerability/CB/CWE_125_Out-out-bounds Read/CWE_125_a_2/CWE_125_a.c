//gcc -o ./CB ./CWE_125_a.c -fno-stack-protector -mpreferred-stack-boundary=2 -m32

#include <stdio.h>

char flag[128]={0,};

void file(){
    FILE *fp=fopen("./flag","r");
    fgets(flag,128,fp);
}

void func(){
    char file_buf[128];
    char buf[128];
    int len;

    strcpy(file_buf,flag);

    printf("Input :");
    read(0,buf,128);
    
    printf("Your Input: %s\n",buf);
}
int main(){

    setbuf(stdin, 0LL);
    setbuf(stdout, 0LL);
    setbuf(stderr, 0LL);
    file();
    func();

    return 0;
}
