//CWE-125:Out-of-bounds Read
//gcc -o ./CB ./CWE_125_a.c -fno-pie -fno-stack-protector -mpreferred-stack-boundary=2 -m32
 
#include <stdio.h>
 
char flag[128]={0,};
 
void file(){
    FILE *fp=fopen("./flag","r");
    fgets(flag,128,fp);
}
 
void func(){
    char file_buf[128];
    char buf[128];
    int len;

    strcpy(file_buf,flag);

    printf("Input len: ");
    scanf("%d",&len);

    if(len<=128){
	
    	for(int i=0; i<len; i++){
		buf[i]="A";
    	}
    }
    printf("Data: %s\n",buf);    
}   
int main(){

    setbuf(stdin, 0LL);
    setbuf(stdout, 0LL);
    setbuf(stderr, 0LL);
    file();
    func();

    return 0;
}
    
