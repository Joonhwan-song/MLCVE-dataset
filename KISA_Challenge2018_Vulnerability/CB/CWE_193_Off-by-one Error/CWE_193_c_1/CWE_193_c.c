//CWE-193: Off-by-one Error
//stackcanary off, delete dummy, ,no pie,32bit binary
//gcc -z execstack -o CB  CWE_193_c.c -fno-pie -fno-stack-protector -mpreferred-stack-boundary=2 -m32
 
#include <stdio.h>
 
char global[128];
 
void shell(){
    system("/bin/sh");
}
 
void vuln(){
    char name[10]={0,};

    printf("What your name: ");
    read(0,name,10);

    if(!strncmp(name,"admin",5)){
    	func();
    }
}
void func(){
    char buf1[128];
    char buf2[128];
 
    read(0,global,128);
 
    printf("COPY.......\n");
 
    strcpy(buf2,global);
    strcpy(buf1,global);
     
    return 0;
}
 
int main(){
	setbuf(stdin, 0LL);
	setbuf(stdout, 0LL);
	setbuf(stderr, 0LL); 
    vuln(); 
	puts("attack fail");
    return 0;
}
