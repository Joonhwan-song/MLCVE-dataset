//gcc -o CB CWE_562_e.c -fno-stack-protector -mpreferred-stack-boundary=2 -m32
#include <stdio.h>

#define name_size 256

char sh[] = "/bin/sh";

void menu(){
	puts("380. get name(name size : 256)");
	puts("312. edit name");
	puts("340. print name");
}

void editname(char *name){
	puts("[edit name]");
	puts("input size?");
	read(0, name, 4);
	if(*(int *)name <= name_size)
		read(0, name, name_size);
	else
		puts("bye");
}
char *getname(){
	char name[name_size];
	char *p = &name;
	read(0, name, name_size);
	return p;
}
int main(){
	int select;
	char *name = malloc(name_size);
	system("clear");
	setbuf(stdout,NULL);
	while(1){
		menu();
		scanf("%d", &select);
		switch(select){
			case 380:
				name = getname();
				break;
			case 312:
				editname(name);
				break;
			case 340:
				puts(name);
				break;
			default:
				puts("attack fail");
				exit(0);
		}
	}
}

/*int main(){
        func();
        puts("attack fail");
}*/
