//gcc -o CB CWE_195_c.c -fno-stack-protector -mpreferred-stack-boundary=2 -m32

#include <stdio.h>
#define namesize 32

char name[namesize];

struct user{
	char *name;
	void (*info)(int);
	int age;
};
int get_size(){
	unsigned int size;
	puts("input size.. < 32 ");
	scanf("%d", &size);
	if(size<=namesize){
		return size;
	}
	return -1;
}
int func(){
	int select;
	struct user *buf;
	struct user buf2;
	int flag = 1;
	char user_name[namesize];
	setbuf(stdout,NULL);

	printf("whats your name?: ");
	read(0, name, namesize);
	printf("whats your real name?: ");
	buf = &buf2;
	buf->name = user_name;
	read(0, buf->name, get_size());
	return 0;
}


int main(){
        func();
        puts("attack fail");
}
