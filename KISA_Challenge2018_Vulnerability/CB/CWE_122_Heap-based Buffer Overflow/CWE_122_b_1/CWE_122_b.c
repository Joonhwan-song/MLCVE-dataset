//gcc -o CB CWE_122_b.c -fno-stack-protector -mpreferred-stack-boundary=2 -m32
#include <stdio.h>

struct func{
	char fname[32];
	void (*print)(char *);
};

void print(char *p){
	puts(p);
}

void solve(){
	system("/bin/sh");
}

int func(){
	struct func *tmp = malloc(sizeof(struct func));
	setbuf(stdout,NULL);
	read(0,tmp->fname,1024);
	tmp->print(tmp->fname);
}
int main(){
	func();
	puts("attack fail");
}
