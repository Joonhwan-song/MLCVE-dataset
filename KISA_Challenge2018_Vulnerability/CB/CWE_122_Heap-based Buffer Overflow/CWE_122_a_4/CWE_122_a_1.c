//gcc -fno-stack-protector -z execstack -o ./CB ./CWE_122_a_1.c -m32

#include <stdio.h>

struct func{
	char fname[32];
	int stat;
};

int func(){
	struct func *tmp = malloc(sizeof(struct func));
	tmp->stat = 0;
	setbuf(stdout,NULL);
	read(0,tmp->fname,1024);
	printf("%x\n", tmp->stat);
	if(tmp->stat == 0x7123481){
		system("/bin/sh");
	}
}

int main(){
	func();
	printf("attack fail");
}
