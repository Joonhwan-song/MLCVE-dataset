//gcc -fno-stack-protector -z execstack -o ./CB ./CWE_122_a.c -m32

#include <stdio.h>
#include <stdlib.h>


int main(void)
{
    setbuf(stdin, 0LL);
    setbuf(stdout, 0LL);
    setbuf(stderr, 0LL);

    FILE* fd = fopen("flag","r");

    char* buf = malloc(0x20);
    char *kkk = malloc(0x50);
    char* flag = malloc(0x30);
    int len=0;

    fread(flag, 1, 0x30, fd);
    fclose(fd);

    printf("read length: ");
    scanf("%d",&len);

    read(0, buf, len);  // Overflow!

    printf("%s\n", buf);
}
