//gcc -fno-stack-protector -z execstack -o ./CB ./CWE_122_b.c -m32

#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    setbuf(stdin, 0LL);
    setbuf(stdout, 0LL);
    setbuf(stderr, 0LL);

    FILE* fd = fopen("flag","r");

    char* buf = malloc(0x20);
    char *kkk = malloc(0x50);
    char* flag = malloc(0x30);

    int len=0;

    fread(flag, 1, 0x30, fd);
    fclose(fd);

    for(;;){
    	printf("Read lenth: ");
	scanf("%d",&len);
	
	if(len !=0){
		read(0, buf, len);  // Overflow!
		break;
	}	
	else{
		puts("attack fail");
	}	
    }
	printf("%s\n", buf);
}
