//gcc -o CB CWE_122_f.c -fno-stack-protector -mpreferred-stack-boundary=2 -m32
#include <stdio.h>

#define size 32

struct user{
	char *name;
	void (*info)(int);
	int age;
};

void menu(){
	puts("1. add user");
	puts("2. edit user");
	puts("3. del user");
	puts("4. info");
}

void info(struct user *a){
	puts(a->name);
	printf("%d\n", a->age);
}
int main(){
	int select;
	struct user *buf;
	scanf("%d", &select);
	if(select != 0xdead){
		printf("mic check");
		exit(0);
	}
	char *tmp = malloc(sizeof(struct user));
	setbuf(stdout,NULL);
	while(1){
		menu();
		scanf("%d", &select);
		switch(select){
			case 1:
				buf = malloc(sizeof(struct user));
				buf->name = malloc(size);
				printf("name: ");
				read(0,buf->name, size);
				printf("age :");
				scanf("%d", &buf->age);
				buf->info = (void *)&info;
				break;
			case 2:
				puts("no;");
				break;
			case 3:
				puts("no;");
				break;
			case 4:
				buf->info(buf);
				break;
			case 1337:
				scanf("%s", tmp);
				puts(tmp);
		}
	}
}

