//gcc -o CB CWE_122_d.c -fno-stack-protector -mpreferred-stack-boundary=2 -m32
#include <stdio.h>

#define size 32

struct user{
	char *name;
	void (*info)(int);
	int age;
};
void solve(){
	system("/bin/sh");
}

void menu(){
	puts("18231. add user");
	puts("18232. edit user");
	puts("18233. del user");
	puts("4. info");
}

void info(struct user *a){
	puts(a->name);
	printf("%d\n", a->age);
}
int main(){
	int select;
	struct user *buf;
	scanf("%d", &select);
	if(select != 0xdead){
		printf("mic check");
		puts("attack fail");
		exit(0);
	}
	char *tmp = malloc(sizeof(struct user));
	setbuf(stdout,NULL);
	while(1){
		menu();
		scanf("%d", &select);
		switch(select){
			case 18231:
				buf = malloc(sizeof(struct user));
				buf->name = malloc(size);
				printf("name: ");
				read(0,buf->name, size);
				printf("age :");
				scanf("%d", &buf->age);
				buf->info = (void *)&info;
				break;
			case 18232:
				puts("no;");
				break;
			case 1823:
				puts("no;");
				break;
			case 4:
				buf->info(buf);
				break;
			case 98765:
				scanf("%s", tmp);
				puts(tmp);
				break;
			default:
				puts("attack fail");
				exit(0);
		}
	}
}
